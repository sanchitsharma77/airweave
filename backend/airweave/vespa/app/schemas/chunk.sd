schema chunk {
    document chunk {
        field entity_id type string {
            indexing: summary | attribute
            attribute: fast-search
        }

        field collection_id type string {
            indexing: summary | attribute
            attribute: fast-search
            rank: filter
        }

        field organization_id type string {
            indexing: summary | attribute
            attribute: fast-search
            rank: filter
        }

        field sync_id type string {
            indexing: summary | attribute
            attribute: fast-search
        }

        field db_entity_id type string {
            indexing: summary | attribute
            attribute: fast-search
        }

        field original_entity_id type string {
            indexing: summary | attribute
            attribute: fast-search
        }

        field source_name type string {
            indexing: summary | attribute
            attribute: fast-search
        }

        field content type string {
            indexing: summary | index
            index: enable-bm25
        }

        field title type string {
            indexing: summary | index
            index: enable-bm25
        }

        field embedding type tensor<bfloat16>(x[3072]) {
            indexing: attribute | index
            attribute {
                distance-metric: angular
                paged
            }
            index {
                hnsw {
                    max-links-per-node: 16
                    neighbors-to-explore-at-insert: 200
                }
            }
        }

        field metadata type string {
            indexing: summary | attribute
        }

        field breadcrumbs type array<string> {
            indexing: summary | attribute
        }

        field url type string {
            indexing: summary | attribute
        }

        field updated_at type long {
            indexing: summary | attribute
            attribute: fast-search
        }

        field created_at type long {
            indexing: summary | attribute
            attribute: fast-search
        }
    }

    fieldset default {
        fields: content, title
    }

    rank-profile default {
        inputs {
            query(embedding) tensor<bfloat16>(x[3072])
        }
        first-phase {
            expression: closeness(field, embedding)
        }
    }

    rank-profile hybrid inherits default {
        first-phase {
            expression: closeness(field, embedding) + bm25(content) + bm25(title)
        }
    }

    rank-profile neural inherits default {
        first-phase {
            expression: closeness(field, embedding)
        }
    }

    rank-profile keyword {
        first-phase {
            expression: bm25(content) + bm25(title)
        }
    }

    rank-profile hybrid_temporal inherits hybrid {
        function recency() {
            expression: if(attribute(updated_at) > 0, 1 / (1 + age(updated_at)), 0)
        }
        first-phase {
            expression: closeness(field, embedding) + bm25(content) + bm25(title) + 0.1 * recency
        }
    }
}
