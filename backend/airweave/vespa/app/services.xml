<?xml version="1.0" encoding="utf-8"?>
<services version="1.0">

  <admin version="2.0">
    <adminserver hostalias="container0"/>
  </admin>

  <!-- Container cluster: handles queries and document API -->
  <container id="default" version="1.0">
    <http>
      <server id="default" port="8081"/>
    </http>
    <search/>
    <document-api/>
    <document-processing/>

    <!-- Default embedder for `embed` in indexing/query pipelines -->
    <component id="nomicmb" type="hugging-face-embedder">
      <transformer-model
        url="https://data.vespa-cloud.com/onnx_models/nomic-ai-modernbert-embed-base/model.onnx"/>
      <tokenizer-model
        url="https://data.vespa-cloud.com/onnx_models/nomic-ai-modernbert-embed-base/tokenizer.json"/>
      <transformer-output>token_embeddings</transformer-output>
      <max-tokens>8192</max-tokens>
      <prepend>
        <query>search_query:</query>
        <document>search_document:</document>
      </prepend>
    </component>

    <nodes>
      <node hostalias="container0"/>
    </nodes>
  </container>

  <!-- Content cluster: stores and indexes documents -->
  <content id="airweave" version="1.0">
    <redundancy>1</redundancy>
    <documents>
      <document type="base_entity" mode="index"/>
      <document type="file_entity" mode="index"/>
      <document type="code_file_entity" mode="index"/>
      <document type="email_entity" mode="index"/>
      <document type="web_entity" mode="index"/>
    </documents>
    <nodes>
      <node hostalias="content0" distribution-key="0"/>
    </nodes>
    <tuning>
      <distribution type="loose"/>
    </tuning>
  </content>

</services>
